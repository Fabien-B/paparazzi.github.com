<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Paparazzi UAS: filter_1euro_imu module</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="penguin_icon.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Paparazzi UAS
   &#160;<span id="projectnumber">v5.18.0_stable</span>
   </div>
   <div id="projectbrief">Paparazzi is a free software Unmanned Aircraft System.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('module__filter_1euro_imu.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">filter_1euro_imu module </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><b>Prefiltering for IMU data using 1euro filter.</b></p>
<p>The 1 Euro filter is an first order low pass filter with an adaptive cutoff frequency. It is able to efficiently remove high frequency noise when the average signal is stable with very small lag by increasing the bandwith to capture faster movements.</p>
<p>Only two parameters are required to tune the filter:</p><ul>
<li>mincutoff that defines the minimum bandwith: reduce it if noise at low speed is a problem</li>
<li>beta that is the adaptation coefficient: increase it if lag at high speed is a problem</li>
</ul>
<p>In order to use this filter for your IMU (on Gyro and Acell data, Mag passthrough), you only need to redefine the source of data in the ABI bindings of the AHRS/INS filter being used. For instance, if the 'ahrs_int_cmpl_quat' AHRS is used, this module should be loaded with the following options: define name="AHRS_ICQ_IMU_ID" value="IMU_F1E_ID" <br  />
 define name="AHRS_ALIGNER_IMU_ID" value="IMU_F1E_ID"</p>
<h1><a class="anchor" id="module_load_example__filter_1euro_imu"></a>
Example for airframe file</h1>
<p>Add to your firmware section: </p><div class="fragment"><div class="line">&lt;<span class="keywordtype">module</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;filter_1euro_imu&quot;</span>/&gt;</div>
</div><!-- fragment --> <h1><a class="anchor" id="configuration__filter_1euro_imu"></a>
Module configuration options</h1>
<h2><a class="anchor" id="af_section"></a>
Airframe file section</h2>
<ul>
<li><b>section</b> name: <code>FILTER_1EURO</code> prefix: <code>FILTER_1EURO_</code> <ul>
<li><b>name</b> <code>ENABLED</code> <b>value:</b> <em>FALSE|TRUE</em> <br  />
 Description: activate or not the filter by default</li>
<li><b>name</b> <code>GYRO_MINCUTOFF</code> <b>value:</b> <em>10.</em> <br  />
 Description: minimum cutoff freq for gyro signal</li>
<li><b>name</b> <code>GYRO_BETA</code> <b>value:</b> <em>0.1</em> <br  />
 Description: adaptation coefficient for gyro signal</li>
<li><b>name</b> <code>ACCEL_MINCUTOFF</code> <b>value:</b> <em>0.1</em> <br  />
 Description: minimum cutoff freq for accel signal</li>
<li><b>name</b> <code>ACCEL_BETA</code> <b>value:</b> <em>0.01</em> <br  />
 Description: adaptation coefficient for accel signal</li>
<li><b>name</b> <code>FREQ</code> <b>value:</b> <em>512</em> <br  />
 Description: set fixed frequency, if not defined but INS/AHRS_PROPAGATE_FREQUENCY is defined it is used, otherwise autofreq is used</li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="functions__filter_1euro_imu"></a>
Module functions</h1>
<h2><a class="anchor" id="init_functions"></a>
Init Functions</h2>
<p>These initialization functions are called once on startup.</p>
<ul>
<li><a class="el" href="filter__1euro__imu_8c.html#ac5440f07272979ecc4ceb8b288758320" title="Init and bindings.">filter_1euro_imu_init()</a></li>
</ul>
<h1><a class="anchor" id="files"></a>
Files</h1>
<h2><a class="anchor" id="headers"></a>
Header Files</h2>
<p>The following headers are automatically included in modules.h</p>
<ul>
<li><a class="el" href="filter__1euro__imu_8h.html">filter_1euro_imu.h</a></li>
</ul>
<h2><a class="anchor" id="sources"></a>
Source Files</h2>
<ul>
<li><a class="el" href="filter__1euro__imu_8c.html">modules/imu/filter_1euro_imu.c</a></li>
</ul>
<h2><a class="anchor" id="module_xml__filter_1euro_imu"></a>
Raw filter_1euro_imu.xml file:</h2>
<div class="fragment"><div class="line">&lt;!<span class="keyword">DOCTYPE</span> <span class="keyword">module</span> <span class="keyword">SYSTEM</span> <span class="stringliteral">&quot;module.dtd&quot;</span>&gt;</div>
<div class="line"> </div>
<div class="line">&lt;<span class="keywordtype">module</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;filter_1euro_imu&quot;</span> <span class="keyword">dir</span>=<span class="stringliteral">&quot;imu&quot;</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">doc</span>&gt;</div>
<div class="line">    &lt;<span class="keywordtype">description</span>&gt;</div>
<div class="line">      <span class="keyword">Prefiltering</span> <span class="keyword">for</span> <span class="keyword">IMU</span> <span class="keyword">data</span> <span class="keyword">using</span> 1<span class="keyword">euro</span> <span class="keyword">filter.</span></div>
<div class="line"> </div>
<div class="line">      <span class="keyword">The</span> 1 <span class="keyword">Euro</span> <span class="keyword">filter</span> <span class="keyword">is</span> <span class="keyword">an</span> <span class="keyword">first</span> <span class="keyword">order</span> <span class="keyword">low</span> <span class="keyword">pass</span> <span class="keyword">filter</span> <span class="keyword">with</span> <span class="keyword">an</span> <span class="keyword">adaptive</span> <span class="keyword">cutoff</span> <span class="keyword">frequency.</span></div>
<div class="line">      <span class="keyword">It</span> <span class="keyword">is</span> <span class="keyword">able</span> <span class="keyword">to</span> <span class="keyword">efficiently</span> <span class="keyword">remove</span> <span class="keyword">high</span> <span class="keyword">frequency</span> <span class="keyword">noise</span> <span class="keyword">when</span> <span class="keyword">the</span> <span class="keyword">average</span> <span class="keyword">signal</span> <span class="keyword">is</span> <span class="keyword">stable</span></div>
<div class="line">      <span class="keyword">with</span> <span class="keyword">very</span> <span class="keyword">small</span> <span class="keyword">lag</span> <span class="keyword">by</span> <span class="keyword">increasing</span> <span class="keyword">the</span> <span class="keyword">bandwith</span> <span class="keyword">to</span> <span class="keyword">capture</span> <span class="keyword">faster</span> <span class="keyword">movements.</span></div>
<div class="line"> </div>
<div class="line">      <span class="keyword">Only</span> <span class="keyword">two</span> <span class="keyword">parameters</span> <span class="keyword">are</span> <span class="keyword">required</span> <span class="keyword">to</span> <span class="keyword">tune</span> <span class="keyword">the</span> <span class="keyword">filter:</span></div>
<div class="line">      - <span class="keyword">mincutoff</span> <span class="keyword">that</span> <span class="keyword">defines</span> <span class="keyword">the</span> <span class="keyword">minimum</span> <span class="keyword">bandwith:</span> <span class="keyword">reduce</span> <span class="keyword">it</span> <span class="keyword">if</span> <span class="keyword">noise</span> <span class="keyword">at</span> <span class="keyword">low</span> <span class="keyword">speed</span> <span class="keyword">is</span> <span class="keyword">a</span> <span class="keyword">problem</span></div>
<div class="line">      - <span class="keyword">beta</span> <span class="keyword">that</span> <span class="keyword">is</span> <span class="keyword">the</span> <span class="keyword">adaptation</span> <span class="keyword">coefficient:</span> <span class="keyword">increase</span> <span class="keyword">it</span> <span class="keyword">if</span> <span class="keyword">lag</span> <span class="keyword">at</span> <span class="keyword">high</span> <span class="keyword">speed</span> <span class="keyword">is</span> <span class="keyword">a</span> <span class="keyword">problem</span></div>
<div class="line"> </div>
<div class="line">      <span class="keyword">In</span> <span class="keyword">order</span> <span class="keyword">to</span> <span class="keyword">use</span> <span class="keyword">this</span> <span class="keyword">filter</span> <span class="keyword">for</span> <span class="keyword">your</span> <span class="keyword">IMU</span> (<span class="keyword">on</span> <span class="keyword">Gyro</span> <span class="keyword">and</span> <span class="keyword">Acell</span> <span class="keyword">data</span>, <span class="keyword">Mag</span> <span class="keyword">passthrough</span>), <span class="keyword">you</span> <span class="keyword">only</span></div>
<div class="line">      <span class="keyword">need</span> <span class="keyword">to</span> <span class="keyword">redefine</span> <span class="keyword">the</span> <span class="keyword">source</span> <span class="keyword">of</span> <span class="keyword">data</span> <span class="keyword">in</span> <span class="keyword">the</span> <span class="keyword">ABI</span> <span class="keyword">bindings</span> <span class="keyword">of</span> <span class="keyword">the</span> <span class="keyword">AHRS</span>/<span class="keyword">INS</span> <span class="keyword">filter</span> <span class="keyword">being</span> <span class="keyword">used.</span></div>
<div class="line">      <span class="keyword">For</span> <span class="keyword">instance</span>, <span class="keyword">if</span> <span class="keyword">the</span> <span class="stringliteral">&#39;ahrs_int_cmpl_quat&#39;</span> <span class="keyword">AHRS</span> <span class="keyword">is</span> <span class="keyword">used</span>, <span class="keyword">this</span> <span class="keyword">module</span> <span class="keyword">should</span> <span class="keyword">be</span> <span class="keyword">loaded</span> <span class="keyword">with</span></div>
<div class="line">      <span class="keyword">the</span> <span class="keyword">following</span> <span class="keyword">options:</span></div>
<div class="line">        <span class="keyword">define</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;AHRS_ICQ_IMU_ID&quot;</span> <span class="keyword">value</span>=<span class="stringliteral">&quot;IMU_F1E_ID&quot;</span>     </div>
<div class="line">        <span class="keyword">define</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;AHRS_ALIGNER_IMU_ID&quot;</span> <span class="keyword">value</span>=<span class="stringliteral">&quot;IMU_F1E_ID&quot;</span>     </div>
<div class="line">    &lt;/<span class="keywordtype">description</span>&gt;</div>
<div class="line">    &lt;<span class="keywordtype">section</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;FILTER_1EURO&quot;</span> <span class="keyword">prefix</span>=<span class="stringliteral">&quot;FILTER_1EURO_&quot;</span>&gt;</div>
<div class="line">      &lt;<span class="keywordtype">define</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;ENABLED&quot;</span> <span class="keyword">value</span>=<span class="stringliteral">&quot;FALSE|TRUE&quot;</span> <span class="keyword">description</span>=<span class="stringliteral">&quot;activate or not the filter by default&quot;</span>/&gt;</div>
<div class="line">      &lt;<span class="keywordtype">define</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;GYRO_MINCUTOFF&quot;</span> <span class="keyword">value</span>=<span class="stringliteral">&quot;10.&quot;</span> <span class="keyword">description</span>=<span class="stringliteral">&quot;minimum cutoff freq for gyro signal&quot;</span>/&gt;</div>
<div class="line">      &lt;<span class="keywordtype">define</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;GYRO_BETA&quot;</span> <span class="keyword">value</span>=<span class="stringliteral">&quot;0.1&quot;</span> <span class="keyword">description</span>=<span class="stringliteral">&quot;adaptation coefficient for gyro signal&quot;</span>/&gt;</div>
<div class="line">      &lt;<span class="keywordtype">define</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;ACCEL_MINCUTOFF&quot;</span> <span class="keyword">value</span>=<span class="stringliteral">&quot;0.1&quot;</span> <span class="keyword">description</span>=<span class="stringliteral">&quot;minimum cutoff freq for accel signal&quot;</span>/&gt;</div>
<div class="line">      &lt;<span class="keywordtype">define</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;ACCEL_BETA&quot;</span> <span class="keyword">value</span>=<span class="stringliteral">&quot;0.01&quot;</span> <span class="keyword">description</span>=<span class="stringliteral">&quot;adaptation coefficient for accel signal&quot;</span>/&gt;</div>
<div class="line">      &lt;<span class="keywordtype">define</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;FREQ&quot;</span> <span class="keyword">value</span>=<span class="stringliteral">&quot;512&quot;</span> <span class="keyword">description</span>=<span class="stringliteral">&quot;set fixed frequency, if not defined but INS/AHRS_PROPAGATE_FREQUENCY is defined it is used, otherwise autofreq is used&quot;</span>/&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">section</span>&gt;</div>
<div class="line">  &lt;/<span class="keywordtype">doc</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">settings</span>&gt;</div>
<div class="line">    &lt;<span class="keywordtype">dl_settings</span>&gt;</div>
<div class="line">      &lt;<span class="keywordtype">dl_settings</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;1e_imu&quot;</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">dl_setting</span> <span class="keyword">min</span>=<span class="stringliteral">&quot;0&quot;</span> <span class="keyword">max</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">step</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">var</span>=<span class="stringliteral">&quot;filter_1e_imu.enabled&quot;</span> <span class="keyword">module</span>=<span class="stringliteral">&quot;imu/filter_1euro_imu&quot;</span> <span class="keyword">shortname</span>=<span class="stringliteral">&quot;enable&quot;</span> <span class="keyword">values</span>=<span class="stringliteral">&quot;DISABLED|ENABLED&quot;</span> <span class="keyword">handler</span>=<span class="stringliteral">&quot;reset&quot;</span>/&gt;</div>
<div class="line">        &lt;<span class="keywordtype">dl_setting</span> <span class="keyword">min</span>=<span class="stringliteral">&quot;0.1&quot;</span> <span class="keyword">max</span>=<span class="stringliteral">&quot;50.&quot;</span> <span class="keyword">step</span>=<span class="stringliteral">&quot;0.1&quot;</span> <span class="keyword">var</span>=<span class="stringliteral">&quot;filter_1e_imu.gyro_mincutoff&quot;</span> <span class="keyword">module</span>=<span class="stringliteral">&quot;imu/filter_1euro_imu&quot;</span> <span class="keyword">shortname</span>=<span class="stringliteral">&quot;gyro mincutoff&quot;</span> <span class="keyword">handler</span>=<span class="stringliteral">&quot;update_gyro_mincutoff&quot;</span>/&gt;</div>
<div class="line">        &lt;<span class="keywordtype">dl_setting</span> <span class="keyword">min</span>=<span class="stringliteral">&quot;0.0001&quot;</span> <span class="keyword">max</span>=<span class="stringliteral">&quot;1.&quot;</span> <span class="keyword">step</span>=<span class="stringliteral">&quot;0.001&quot;</span> <span class="keyword">var</span>=<span class="stringliteral">&quot;filter_1e_imu.gyro_beta&quot;</span> <span class="keyword">module</span>=<span class="stringliteral">&quot;imu/filter_1euro_imu&quot;</span> <span class="keyword">shortname</span>=<span class="stringliteral">&quot;gyro beta&quot;</span> <span class="keyword">handler</span>=<span class="stringliteral">&quot;update_gyro_beta&quot;</span>/&gt;</div>
<div class="line">        &lt;<span class="keywordtype">dl_setting</span> <span class="keyword">min</span>=<span class="stringliteral">&quot;0.01&quot;</span> <span class="keyword">max</span>=<span class="stringliteral">&quot;10.&quot;</span> <span class="keyword">step</span>=<span class="stringliteral">&quot;0.001&quot;</span> <span class="keyword">var</span>=<span class="stringliteral">&quot;filter_1e_imu.accel_mincutoff&quot;</span> <span class="keyword">module</span>=<span class="stringliteral">&quot;imu/filter_1euro_imu&quot;</span> <span class="keyword">shortname</span>=<span class="stringliteral">&quot;accel mincutoff&quot;</span> <span class="keyword">handler</span>=<span class="stringliteral">&quot;update_accel_mincutoff&quot;</span>/&gt;</div>
<div class="line">        &lt;<span class="keywordtype">dl_setting</span> <span class="keyword">min</span>=<span class="stringliteral">&quot;0.0001&quot;</span> <span class="keyword">max</span>=<span class="stringliteral">&quot;.1&quot;</span> <span class="keyword">step</span>=<span class="stringliteral">&quot;0.001&quot;</span> <span class="keyword">var</span>=<span class="stringliteral">&quot;filter_1e_imu.accel_beta&quot;</span> <span class="keyword">module</span>=<span class="stringliteral">&quot;imu/filter_1euro_imu&quot;</span> <span class="keyword">shortname</span>=<span class="stringliteral">&quot;accel beta&quot;</span> <span class="keyword">handler</span>=<span class="stringliteral">&quot;update_accel_beta&quot;</span>/&gt;</div>
<div class="line">      &lt;/<span class="keywordtype">dl_settings</span>&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">dl_settings</span>&gt;</div>
<div class="line">  &lt;/<span class="keywordtype">settings</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">header</span>&gt;</div>
<div class="line">    &lt;<span class="keywordtype">file</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;filter_1euro_imu.h&quot;</span>/&gt;</div>
<div class="line">  &lt;/<span class="keywordtype">header</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">init</span> <span class="keyword">fun</span>=<span class="stringliteral">&quot;filter_1euro_imu_init()&quot;</span>/&gt;</div>
<div class="line">  &lt;<span class="keywordtype">makefile</span>&gt;</div>
<div class="line">    &lt;<span class="keywordtype">file</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;filter_1euro_imu.c&quot;</span>/&gt;</div>
<div class="line">  &lt;/<span class="keywordtype">makefile</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">module</span>&gt;</div>
<div class="line"> </div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="onboard_modules.html">Onboard Modules</a></li>
    <li class="footer">Generated on Mon Jan 31 2022 17:29:27 for Paparazzi UAS by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
