<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.4"/>
<title>Paparazzi UAS: SPI logger</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="penguin_icon.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Paparazzi UAS
   &#160;<span id="projectnumber">v5.4.0_stable-0-g24683db</span>
   </div>
   <div id="projectbrief">Paparazzi is a free software Unmanned Aircraft System.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.4 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('module__high_speed_logger_direct_memory.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">SPI logger </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Module XML file: <code>high_speed_logger_direct_memory.xml</code> </p>
<p>A logger that connects and manage a memory directly connected to th SPI.</p>
<p>This module includes some configurations :</p>
<ul>
<li><b>ERASE_MEMORY_AT_START</b> : if set to 1 the memory will be erased completly when starting a new log. This will take a little bit less than a minute, but afterwards you will be able to log values at a higher rate than if you didn't do it. If you let it to 0, the module is going to erase the memory block by block of 4K when needed.</li>
<li><b>SIZE_OF_LOGGED_VALUES</b> : the number of Bytes that each value logged must be (in memory). You can write a 4 Bytes values in a 2 Bytes slots, you just need to be certain that you don't have any overflows.</li>
<li><b>NBR_VALUES_TO_LOG</b> : the number of messages you want to log. This value is equivalent to the size of the values_to_log array.</li>
<li><b>SKIP_X_CALLS_BETWEEN_VALUES</b> : you might want to slow down the logger instead of losing values (because of buffer overflows). if that value is set to 0, a new value of every logged messages will be added to the buffer. If set to 2, we will wait two calls to the module, then during the third one we will writte the values to the buffer. By default this modules is called at 512Hz.</li>
</ul>
<p>Then you have two arrays :</p>
<ul>
<li><b>values_to_log</b> : containing the pointer to the values to log.</li>
<li><b>name_of_the_values</b> : the name of the messages logged. This is simply an aesthetic configuration, for you to know which message were logged.</li>
</ul>
<p>The applicaton to read the memory back is available here : <a href="http://karlito139.github.io/lisa_s_logger_reader/">http://karlito139.github.io/lisa_s_logger_reader/</a></p>
<p>For more informations on how to use this module you can refer to the wiki : <a href="http://wiki.paparazziuav.org/wiki/Micro_logger">http://wiki.paparazziuav.org/wiki/Micro_logger</a></p>
<h1><a class="anchor" id="configuration"></a>
Module configuration options</h1>
<h2><a class="anchor" id="configure"></a>
Configure Options</h2>
<ul>
<li><b>name:</b> <code>HS_LOG_UART</code> <b>value:</b> <em>UART1|UART2|UART3|UART4|UART5|UART6</em> <br/>
 Description: Port to read back the memory</li>
<li><b>name:</b> <code>HS_LOG_SPI</code> <b>value:</b> <em>SPI1|SPI2|SPI3|SPI4|SPI5|SPI6</em> <br/>
 Description: Port to read back the memory</li>
<li><b>name:</b> <code>HS_LOG_SPI_SLAVE</code> <b>value:</b> <em>SPI_SLAVE1|SPI_SLAVE2|SPI_SLAVE3|SPI_SLAVE4|SPI_SLAVE5|SPI_SLAVE6</em> <br/>
 Description: Port to read back the memory</li>
</ul>
<h1><a class="anchor" id="functions"></a>
Module functions</h1>
<h2><a class="anchor" id="init_functions"></a>
Init Functions</h2>
<p>These initialization functions are called once on startup.</p>
<ul>
<li><a class="el" href="high__speed__logger__direct__memory_8c.html#a12bdb7bbc1db80d13434e986b45f0128" title="Function initialisating the module. ">high_speed_logger_direct_memory_init()</a></li>
</ul>
<h2><a class="anchor" id="periodic_functions"></a>
Periodic Functions</h2>
<p>These functions are called periodically at the specified frequency from the module periodic loop.</p>
<ul>
<li><a class="el" href="high__speed__logger__direct__memory_8c.html#a9464826fae91544e9fc803865f5e3107" title="Main function of the module. ">high_speed_logger_direct_memory_periodic()</a><ul>
<li>Running at maximum module frequency.</li>
<li>Autorun: <em>TRUE</em> <br/>
 Periodic function automatically starts after init.</li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="files"></a>
Files</h1>
<h2><a class="anchor" id="headers"></a>
Header Files</h2>
<p>The following headers are automatically included in modules.h</p>
<ul>
<li><a class="el" href="high__speed__logger__direct__memory_8h.html">high_speed_logger_direct_memory.h</a></li>
</ul>
<h2><a class="anchor" id="sources"></a>
Source Files</h2>
<ul>
<li><a class="el" href="high__speed__logger__direct__memory_8c.html">modules/loggers/high_speed_logger_direct_memory.c</a></li>
</ul>
<h2><a class="anchor" id="module_xml__high_speed_logger_direct_memory"></a>
Raw high_speed_logger_direct_memory.xml file:</h2>
<div class="fragment"><div class="line">&lt;!DOCTYPE module SYSTEM <span class="stringliteral">&quot;module.dtd&quot;</span>&gt;</div>
<div class="line"></div>
<div class="line">&lt;module name=<span class="stringliteral">&quot;loggers&quot;</span>&gt;</div>
<div class="line">  &lt;doc&gt;</div>
<div class="line">    &lt;description&gt;</div>
<div class="line">SPI logger</div>
<div class="line"><a class="code" href="pprz__geodetic__utm_8h.html#a955f504eccf76b4eb2489c0adab03121">A</a> logger that connects and manage a memory directly connected to th SPI.</div>
<div class="line"></div>
<div class="line">This module includes some configurations :</div>
<div class="line">- @b <a class="code" href="high__speed__logger__direct__memory_8c.html#aae203a8165f66fc3887fa9cfbb8ba904" title="if we completly erase the memory at the start of the log. ">ERASE_MEMORY_AT_START</a> : <span class="keywordflow">if</span> set to 1 the memory will be erased completly when starting a <span class="keyword">new</span> log. This will take a little bit less than a minute, but afterwards you will be able to log values at a higher rate than <span class="keywordflow">if</span> you didn<span class="stringliteral">&#39;t do it. If you let it to 0, the module is going to erase the memory block by block of 4K when needed.</span></div>
<div class="line"><span class="stringliteral">- @b SIZE_OF_LOGGED_VALUES : the number of Bytes that each value logged must be (in memory). You can write a 4 Bytes values in a 2 Bytes slots, you just need to be certain that you don&#39;</span>t have any overflows.</div>
<div class="line">- @b <a class="code" href="high__speed__logger__direct__memory_8c.html#a77508b5bad1b92f44aa98c8f6b31d3fd" title="nbr of messages you want to log ">NBR_VALUES_TO_LOG</a> : the number of messages you want to log. This <a class="code" href="stm32_2mcu__periph_2adc__arch_8c.html#a900b69af7d674b8db3bceae754b4955a">value</a> is equivalent to the size of the <a class="code" href="high__speed__logger__direct__memory_8c.html#a9bb9556634a30631566d56635357a786" title="list of the messages you want to log ">values_to_log</a> array.</div>
<div class="line">- @b <a class="code" href="high__speed__logger__direct__memory_8c.html#a505acbcfa5f466fea3d39fa956a06074" title="Skip X values between write. ">SKIP_X_CALLS_BETWEEN_VALUES</a> : you might want to slow down the logger instead of losing values (because of <a class="code" href="ahrs__ardrone2_8c.html#afcd770f92b25f2767b0dd71ffbdf7439">buffer</a> overflows). <span class="keywordflow">if</span> that <a class="code" href="stm32_2mcu__periph_2adc__arch_8c.html#a900b69af7d674b8db3bceae754b4955a">value</a> is set to 0, a <span class="keyword">new</span> <a class="code" href="stm32_2mcu__periph_2adc__arch_8c.html#a900b69af7d674b8db3bceae754b4955a">value</a> of every logged messages will be added to the <a class="code" href="ahrs__ardrone2_8c.html#afcd770f92b25f2767b0dd71ffbdf7439">buffer</a>. If set to 2, we will wait two calls to the module, then during the third one we will writte the values to the <a class="code" href="ahrs__ardrone2_8c.html#afcd770f92b25f2767b0dd71ffbdf7439">buffer</a>. By <span class="keywordflow">default</span> <span class="keyword">this</span> modules is called at 512Hz.</div>
<div class="line"></div>
<div class="line">Then you have two arrays :</div>
<div class="line"></div>
<div class="line">- @b <a class="code" href="high__speed__logger__direct__memory_8c.html#a9bb9556634a30631566d56635357a786" title="list of the messages you want to log ">values_to_log</a> : containing the pointer to the values to log.</div>
<div class="line">- @b <a class="code" href="high__speed__logger__direct__memory_8c.html#a040532bb23c0133a5daca786b77ad311" title="list of the names of the messages you are logging ">name_of_the_values</a> : the name of the messages logged. This is simply an aesthetic configuration, <span class="keywordflow">for</span> you to know which message were logged.</div>
<div class="line"></div>
<div class="line">The applicaton to read the memory back is available here : http:<span class="comment">//karlito139.github.io/lisa_s_logger_reader/</span></div>
<div class="line"></div>
<div class="line">For more informations on how to use <span class="keyword">this</span> module you can refer to the wiki : http:<span class="comment">//wiki.paparazziuav.org/wiki/Micro_logger</span></div>
<div class="line">    &lt;/description&gt;</div>
<div class="line">    &lt;configure name=<span class="stringliteral">&quot;HS_LOG_UART&quot;</span> <a class="code" href="stm32_2mcu__periph_2adc__arch_8c.html#a900b69af7d674b8db3bceae754b4955a">value</a>=<span class="stringliteral">&quot;UART1|UART2|UART3|UART4|UART5|UART6&quot;</span> description=<span class="stringliteral">&quot;Port to read back the memory&quot;</span>/&gt;</div>
<div class="line">    &lt;configure name=<span class="stringliteral">&quot;HS_LOG_SPI&quot;</span> <a class="code" href="stm32_2mcu__periph_2adc__arch_8c.html#a900b69af7d674b8db3bceae754b4955a">value</a>=<span class="stringliteral">&quot;SPI1|SPI2|SPI3|SPI4|SPI5|SPI6&quot;</span> description=<span class="stringliteral">&quot;Port to read back the memory&quot;</span>/&gt;</div>
<div class="line">    &lt;configure name=<span class="stringliteral">&quot;HS_LOG_SPI_SLAVE&quot;</span> <a class="code" href="stm32_2mcu__periph_2adc__arch_8c.html#a900b69af7d674b8db3bceae754b4955a">value</a>=<span class="stringliteral">&quot;SPI_SLAVE1|SPI_SLAVE2|SPI_SLAVE3|SPI_SLAVE4|SPI_SLAVE5|SPI_SLAVE6&quot;</span> description=<span class="stringliteral">&quot;Port to read back the memory&quot;</span>/&gt;</div>
<div class="line">  &lt;/doc&gt;</div>
<div class="line">  &lt;settings&gt;</div>
<div class="line">    &lt;dl_settings&gt;</div>
<div class="line">      &lt;dl_settings NAME=<span class="stringliteral">&quot;logger&quot;</span>&gt;</div>
<div class="line">        &lt;dl_setting shortname=<span class="stringliteral">&quot;Status&quot;</span> var=<span class="stringliteral">&quot;logging_status_gui&quot;</span> min=<span class="stringliteral">&quot;0&quot;</span> max=<span class="stringliteral">&quot;3&quot;</span> module=<span class="stringliteral">&quot;loggers/high_speed_logger_direct_memory&quot;</span> values=<span class="stringliteral">&quot;idle|Initialise|start log|stop log&quot;</span> handler=<span class="stringliteral">&quot;handler&quot;</span>/&gt;</div>
<div class="line">      &lt;/dl_settings&gt;</div>
<div class="line">    &lt;/dl_settings&gt;</div>
<div class="line">  &lt;/settings&gt;</div>
<div class="line">  &lt;<a class="code" href="stm32_2usb__ser__hw_8c.html#a9a8392067ad0235c042c6ae9db0cf963">header</a>&gt;</div>
<div class="line">    &lt;file name=<span class="stringliteral">&quot;high_speed_logger_direct_memory.h&quot;</span>/&gt;</div>
<div class="line">  &lt;/<a class="code" href="stm32_2usb__ser__hw_8c.html#a9a8392067ad0235c042c6ae9db0cf963">header</a>&gt;</div>
<div class="line">  &lt;<a class="code" href="nav__gls_8c.html#ada161ed38a9174ff5b3a4f10b10fd238">init</a> fun=<span class="stringliteral">&quot;high_speed_logger_direct_memory_init()&quot;</span>/&gt;</div>
<div class="line">  &lt;periodic fun=<span class="stringliteral">&quot;high_speed_logger_direct_memory_periodic()&quot;</span> autorun=<span class="stringliteral">&quot;TRUE&quot;</span>/&gt;</div>
<div class="line">  &lt;makefile&gt;</div>
<div class="line"></div>
<div class="line">    &lt;raw&gt;</div>
<div class="line">      HS_LOG_UART ?= uart3</div>
<div class="line">      HS_LOG_UART_LOWER=$(shell echo $(HS_LOG_UART) | tr <a class="code" href="pprz__geodetic__utm_8h.html#a955f504eccf76b4eb2489c0adab03121">A</a>-Z a-z)</div>
<div class="line">      HS_LOG_UART_UPPER=$(shell echo $(HS_LOG_UART) | tr a-z <a class="code" href="pprz__geodetic__utm_8h.html#a955f504eccf76b4eb2489c0adab03121">A</a>-Z)</div>
<div class="line"></div>
<div class="line">      HS_LOG_SPI ?= <a class="code" href="group__spi.html#gaedccba8390a9d630d522a0b282c4f9b9" title="receive transferred over DMA ">spi1</a></div>
<div class="line">      HS_LOG_SPI_LOWER=$(shell echo $(HS_LOG_SPI) | tr <a class="code" href="pprz__geodetic__utm_8h.html#a955f504eccf76b4eb2489c0adab03121">A</a>-Z a-z)</div>
<div class="line">      HS_LOG_SPI_UPPER=$(shell echo $(HS_LOG_SPI) | tr a-z <a class="code" href="pprz__geodetic__utm_8h.html#a955f504eccf76b4eb2489c0adab03121">A</a>-Z)</div>
<div class="line"></div>
<div class="line">      HS_LOG_SPI_SLAVE ?= spi_slave1</div>
<div class="line">      HS_LOG_SPI_SLAVE_LOWER=$(shell echo $(HS_LOG_SPI_SLAVE) | tr <a class="code" href="pprz__geodetic__utm_8h.html#a955f504eccf76b4eb2489c0adab03121">A</a>-Z a-z)</div>
<div class="line">      HS_LOG_SPI_SLAVE_UPPER=$(shell echo $(HS_LOG_SPI_SLAVE) | tr a-z <a class="code" href="pprz__geodetic__utm_8h.html#a955f504eccf76b4eb2489c0adab03121">A</a>-Z)</div>
<div class="line">    &lt;/raw&gt;</div>
<div class="line"></div>
<div class="line">    &lt;define name=<span class="stringliteral">&quot;SPI_MASTER&quot;</span> <a class="code" href="stm32_2mcu__periph_2adc__arch_8c.html#a900b69af7d674b8db3bceae754b4955a">value</a>=<span class="stringliteral">&quot;1&quot;</span> /&gt;</div>
<div class="line">    &lt;define name=<span class="stringliteral">&quot;USE_$(HS_LOG_SPI_UPPER)&quot;</span> <a class="code" href="stm32_2mcu__periph_2adc__arch_8c.html#a900b69af7d674b8db3bceae754b4955a">value</a>=<span class="stringliteral">&quot;1&quot;</span> /&gt;</div>
<div class="line">    &lt;define name=<span class="stringliteral">&quot;USE_$(HS_LOG_SPI_SLAVE_UPPER)&quot;</span> <a class="code" href="stm32_2mcu__periph_2adc__arch_8c.html#a900b69af7d674b8db3bceae754b4955a">value</a>=<span class="stringliteral">&quot;1&quot;</span> /&gt;</div>
<div class="line">    &lt;define name=<span class="stringliteral">&quot;HIGH_SPEED_LOGGER_DIRECT_MEMORY_DEVICE&quot;</span> <a class="code" href="stm32_2mcu__periph_2adc__arch_8c.html#a900b69af7d674b8db3bceae754b4955a">value</a>=<span class="stringliteral">&quot;$(HS_LOG_SPI_LOWER)&quot;</span> /&gt;</div>
<div class="line">    &lt;define name=<span class="stringliteral">&quot;HIGH_SPEED_LOGGER_DIRECT_MEMORY_SLAVE_NUMBER&quot;</span> <a class="code" href="stm32_2mcu__periph_2adc__arch_8c.html#a900b69af7d674b8db3bceae754b4955a">value</a>=<span class="stringliteral">&quot;$(HS_LOG_SPI_SLAVE_UPPER)&quot;</span> /&gt;</div>
<div class="line"></div>
<div class="line">    &lt;define name=<span class="stringliteral">&quot;HS_LOG_UART&quot;</span> <a class="code" href="stm32_2mcu__periph_2adc__arch_8c.html#a900b69af7d674b8db3bceae754b4955a">value</a>=<span class="stringliteral">&quot;$(HS_LOG_UART_LOWER)&quot;</span>/&gt;</div>
<div class="line">    &lt;define name=<span class="stringliteral">&quot;USE_$(HS_LOG_UART_UPPER)&quot;</span>/&gt;</div>
<div class="line">    &lt;define name=<span class="stringliteral">&quot;$(HS_LOG_UART_UPPER)_BAUD&quot;</span> <a class="code" href="stm32_2mcu__periph_2adc__arch_8c.html#a900b69af7d674b8db3bceae754b4955a">value</a>=<span class="stringliteral">&quot;B115200&quot;</span>/&gt;</div>
<div class="line"></div>
<div class="line">    &lt;file name=<span class="stringliteral">&quot;high_speed_logger_direct_memory.c&quot;</span>/&gt;</div>
<div class="line">  &lt;/makefile&gt;</div>
<div class="line">&lt;/module&gt;</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="onboard_modules.html">Onboard Modules</a></li>
    <li class="footer">Generated on Mon Jan 5 2015 08:05:17 for Paparazzi UAS by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.4 </li>
  </ul>
</div>
</body>
</html>
